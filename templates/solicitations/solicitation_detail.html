{% extends "base/base.html" %}

{% load static %}

{% block page_title %} Detalles {% endblock %}

{% load widget_tweaks %} {# Cargar widget tweaks para personalizar los inputs #}

{% block content %}
<div class="w-full ">
  <c-nav.basic name="Solicitud {{ solicitation.id }}">
    <c-btn.create url="auto_solicitation_create" title="Solicitud {{ solicitation.id }}"></c-btn.create>
  </c-nav.basic>

  <h1 class="text-2xl font-bold mb-6 text-gray-800">Detalle de Solicitud</h1>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- Columna 1: Formulario de la Solicitud -->
    <div class="bg-white shadow-md rounded-lg p-6">
      <h2 class="text-lg font-semibold mb-4 text-gray-700">Formulario de Solicitud</h2>

      <form method="POST" action="{% url 'solicitation_edit' solicitation.pk %}" class="space-y-4">
        {% csrf_token %}

        <!-- Fecha de Solicitud -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Fecha de Solicitud</label>
          {{ form.requested_at|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Tipo de Solicitud -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Tipo de Solicitud</label>
          {{ form.solicitation_type|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Razón -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Razón</label>
          {{ form.reason|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Empleado -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Empleado</label>
          {{ form.employee|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Área -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Área</label>
          {{ form.area|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Departamento -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Departamento</label>
          {{ form.department|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Orden de Trabajo -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Orden de Trabajo</label>
          {{ form.work_order|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <!-- Cliente -->
        <div>
          <label class="block text-sm font-semibold text-gray-700">Cliente</label>
          {{ form.client|add_class:"w-full px-4 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500" }}
        </div>

        <div class="flex justify-end mt-4">
          <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition">
            Guardar cambios
          </button>
        </div>
      </form>
    </div>

    <!-- Columna 2: Partial específico según el tipo -->
    <div class="bg-white shadow-md rounded-lg p-6">
      <h2 class="text-lg font-semibold mb-4 text-gray-700">Detalles adicionales</h2>
      {% with partial_template="solicitations/partials/_detail_"|add:solicitation.solicitation_type|add:".html" %}
      {% include partial_template %}
      {% endwith %}
    </div>
  </div>

  <!-- Información de la Solicitud -->
  <div class="mt-8 bg-white shadow-md rounded-lg p-6">
    <h2 class="text-lg font-semibold mb-4 text-gray-700">Información de la Solicitud</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <p><strong class="text-gray-700">Correlativo:</strong> {{ solicitation.correlative }}</p>
      <p><strong class="text-gray-700">Razón:</strong> {{ solicitation.reason }}</p>
      <p><strong class="text-gray-700">Estado:</strong> {{ solicitation.get_status_display }}</p>
      <p><strong class="text-gray-700">Orden de Trabajo:</strong>
        {% if solicitation.work_order %}
        {{ solicitation.work_order }}
        {% else %}
        <span class="text-red-500">No asignada</span>
        {% endif %}
      </p>
    </div>
  </div>

</div>
{% endblock %}
